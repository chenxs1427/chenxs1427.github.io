<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Chen's Blog</title><meta name="author" content="Chen Xs"><meta name="copyright" content="Chen Xs"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta property="og:type" content="website">
<meta property="og:title" content="Chen&#39;s Blog">
<meta property="og:url" content="https://chenxs1427.github.io/page/8/index.html">
<meta property="og:site_name" content="Chen&#39;s Blog">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s2.loli.net/2023/06/28/qRyt6e5NoVs4cdD.jpg">
<meta property="article:author" content="Chen Xs">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s2.loli.net/2023/06/28/qRyt6e5NoVs4cdD.jpg"><link rel="shortcut icon" href="https://s2.loli.net/2023/04/15/3vnNmAl8Yxa5EIK.png"><link rel="canonical" href="https://chenxs1427.github.io/page/8/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: Chen Xs","link":"链接: ","source":"来源: Chen's Blog","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Chen\'s Blog',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2024-02-11 22:37:24'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/background.css"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-electric-clock-plus@latest/css/clock.css"><link rel="stylesheet" href="https://unpkg.zhimg.com/hexo-butterfly-footer-beautify@1.0.0/lib/runtime.css" media="print" onload="this.media='all'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.0.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "https://cdn.jsdelivr.net/gh/cxs1427/my_blog_files/loading.gif" data-lazy-src="https://s2.loli.net/2023/06/28/qRyt6e5NoVs4cdD.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">82</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">19</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/cat/"><i class="fa-fw fas fa-regular fa-cat fa-bounce"></i><span> 喵喵</span></a></div><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 生活</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/galleryGroup/"><i class="fa-fw fas fa-leaf"></i><span> 相册</span></a></li><li><a class="site-page child" href="/college-poems/"><i class="fa-fw fas fa-fire"></i><span> 诗选</span></a></li><li><a class="site-page child" href="/books/"><i class="fa-fw fas fa-book"></i><span> 读书</span></a></li><li><a class="site-page child" href="/cooks/"><i class="fa-fw fas fa-utensils"></i><span> 厨艺</span></a></li><li><a class="site-page child" href="/cinemas/"><i class="fa-fw fas fa-mountain"></i><span> 追剧</span></a></li><li><a class="site-page child" href="/bangumis/"><i class="fa-fw fas fa-yin-yang"></i><span> 追番</span></a></li><li><a class="site-page child" href="/cars/"><i class="fa-fw fas fa-car"></i><span> 科目三</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/games/"><i class="fa-fw fas fa-sign-language"></i><span> 游戏</span></a></div><div class="menus_item"><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></div><div class="menus_item"><a class="site-page" href="/money/"><i class="fa-fw fas fa-sack-dollar"></i><span> 项目</span></a></div><div class="menus_item"><a class="site-page" href="/about-me/"><i class="fa-fw fas fa-heart fa-beat"></i><span> 关于</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('https://s2.loli.net/2023/06/28/TeGHI4W1UuqSXDg.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Chen's Blog</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/cat/"><i class="fa-fw fas fa-regular fa-cat fa-bounce"></i><span> 喵喵</span></a></div><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 生活</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/galleryGroup/"><i class="fa-fw fas fa-leaf"></i><span> 相册</span></a></li><li><a class="site-page child" href="/college-poems/"><i class="fa-fw fas fa-fire"></i><span> 诗选</span></a></li><li><a class="site-page child" href="/books/"><i class="fa-fw fas fa-book"></i><span> 读书</span></a></li><li><a class="site-page child" href="/cooks/"><i class="fa-fw fas fa-utensils"></i><span> 厨艺</span></a></li><li><a class="site-page child" href="/cinemas/"><i class="fa-fw fas fa-mountain"></i><span> 追剧</span></a></li><li><a class="site-page child" href="/bangumis/"><i class="fa-fw fas fa-yin-yang"></i><span> 追番</span></a></li><li><a class="site-page child" href="/cars/"><i class="fa-fw fas fa-car"></i><span> 科目三</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/games/"><i class="fa-fw fas fa-sign-language"></i><span> 游戏</span></a></div><div class="menus_item"><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></div><div class="menus_item"><a class="site-page" href="/money/"><i class="fa-fw fas fa-sack-dollar"></i><span> 项目</span></a></div><div class="menus_item"><a class="site-page" href="/about-me/"><i class="fa-fw fas fa-heart fa-beat"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">Chen's Blog</h1><div id="site-subtitle"><span id="subtitle"></span></div><div id="site_social_icons"><a class="social-icon" href="https://github.com/cxs1427" target="_blank" title="Github"><i class="fab fa-github"></i></a></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left"><a href="/2022/04/16/web%E9%80%86%E5%90%91-%E8%B1%86%E7%93%A3%E8%AF%BB%E4%B9%A6%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3/" title="web逆向-豆瓣读书搜索接口"><img class="post_bg" src= "https://cdn.jsdelivr.net/gh/cxs1427/my_blog_files/loading.gif" data-lazy-src="https://s2.loli.net/2023/09/28/rYJHbGxS9yDacLu.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="web逆向-豆瓣读书搜索接口"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/04/16/web%E9%80%86%E5%90%91-%E8%B1%86%E7%93%A3%E8%AF%BB%E4%B9%A6%E6%90%9C%E7%B4%A2%E6%8E%A5%E5%8F%A3/" title="web逆向-豆瓣读书搜索接口">web逆向-豆瓣读书搜索接口</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-04-16T10:09:48.000Z" title="发表于 2022-04-16 18:09:48">2022-04-16</time></span></div><div class="content">一直都想写这篇，但之前都太懒，久而久之成了心里的一道坎
首先来看一下原始数据，可以看到 window.DATA 里面是一大串意义不明的乱码
直接全局搜索 window.__DATA__ 然后下断点，刷新页面
进入到 Lt.dispatch 函数内部
这里很明显，r 就是 window.__DATA__，即原始数据，e(t)(n) 意思是原始数据经过了若干个函数的处理
我们进入到函数内部，看看具体做了什么，以及怎么用python来实现相同的功能
第一个函数首先是 (n) 函数
可以看到里面有好几处处理，我们一个一个来复现

a = e.from(r, “base64”)原始数据r经过e.from函数的处理后，变成了Unit8Array的数据类型，其实就是对原始数据进行 base64 解码python主要使用base64标准库实现
1a = list(base64.b64decode(data))
从上图可以看到两个的效果都是一样的

s 和 u
12s = Math.max(Math.floor((a.length - 2 * i) / 3), 0)u = a.slice(s, s +  ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2022/03/10/2020~2022%E5%B7%A5%E4%BD%9C%E7%AC%94%E8%AE%B0/" title="2020~2022工作笔记"><img class="post_bg" src= "https://cdn.jsdelivr.net/gh/cxs1427/my_blog_files/loading.gif" data-lazy-src="https://s2.loli.net/2023/09/28/93YS6rtJjkDhq8I.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2020~2022工作笔记"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/03/10/2020~2022%E5%B7%A5%E4%BD%9C%E7%AC%94%E8%AE%B0/" title="2020~2022工作笔记">2020~2022工作笔记</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-03-09T22:42:39.000Z" title="发表于 2022-03-10 06:42:39">2022-03-10</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E5%B7%A5%E4%BD%9C%E6%80%BB%E7%BB%93/">工作总结</a></span></div><div class="content">Pycharm常用快捷键
ctrl + e   查看最近编辑文件
ctrl + shift + r  根据文件名查找文件
ctrl + h  全局搜索
ctrl + alt + o  优化导入包排序

快捷键设置：
放大、缩小设置：File -&gt;setting-&gt; Keymap-&gt;搜索框中输入:Increase Font Size(双击选中)-&gt;弹出对话框时选择Add Mouse Shortcut(单击)
json、pickle、shelve 各自数据序列化方式的异同和用法json适用于不同类型的语言，支持的数据类型：int\str\list\tuple\dict主要是操作字符串dumps、loads操作 字符串dump、load 操作 文件 （pickle一样的情况）
123456789# dump入文件 with open(&#x27;cxs.json&#x27;,&#x27;w&#x27;) as f:	json.dump(data,fp)json.dump(item, fp=open(&quot;zhihu_comment.json&quot;, &qu ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2022/02/22/2022~2023%E5%B7%A5%E4%BD%9C%E7%AC%94%E8%AE%B0/" title="2022~2023工作笔记"><img class="post_bg" src= "https://cdn.jsdelivr.net/gh/cxs1427/my_blog_files/loading.gif" data-lazy-src="https://s2.loli.net/2023/09/28/d4iCTPIKnpvxOjG.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="2022~2023工作笔记"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/02/22/2022~2023%E5%B7%A5%E4%BD%9C%E7%AC%94%E8%AE%B0/" title="2022~2023工作笔记">2022~2023工作笔记</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-02-22T01:39:24.000Z" title="发表于 2022-02-22 09:39:24">2022-02-22</time></span></div><div class="content">
  0701657335e84f0c327f6bba26337f2a8d2ddfaa04a524a7a3f409fdb8f6089378eadb916c2a3e34bc5f74b21929862ecacf06575cac1a906d3d9fb862c480acbf065fa7ef3edbace837425efe4e0a8324a3f6dac879a6f0ce60803afab30a830cf4270742c621dedf8f093587d5bc0d08b7ea30857b214f55ad79848478e33d58a67e438c33c79890d2a5918b8a21ccd23baf5bfffc946a52e880db57f03798f670935127e0f4e9f3becd6f1cf8f9a47895f7a3dc919bbc9388bade17115f503cef597e4f328572f981668f2f9385526c2f855989c93fe7d0d73c5a80609248d63b73315d3117e050a1465ef795fb490e42049615ffa1a42 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2022/02/22/%E7%88%AC%E8%99%AB%E5%B7%A5%E7%A8%8B%E5%B8%88-%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%A2%98%E6%B1%87%E6%80%BB/" title="爬虫工程师-常见面试题汇总"><img class="post_bg" src= "https://cdn.jsdelivr.net/gh/cxs1427/my_blog_files/loading.gif" data-lazy-src="https://s2.loli.net/2023/09/28/EwX1k3UA6lrnP5R.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="爬虫工程师-常见面试题汇总"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/02/22/%E7%88%AC%E8%99%AB%E5%B7%A5%E7%A8%8B%E5%B8%88-%E5%B8%B8%E8%A7%81%E9%9D%A2%E8%AF%95%E9%A2%98%E6%B1%87%E6%80%BB/" title="爬虫工程师-常见面试题汇总">爬虫工程师-常见面试题汇总</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-02-22T01:39:24.000Z" title="发表于 2022-02-22 09:39:24">2022-02-22</time></span></div><div class="content">
  0701657335e84f0c327f6bba26337f2ad6ca4ba8e3335a3698f9be1e4802627d599e225460817a2b3c3f7165a8361f79223ccd603cec4949682d8998388f760308d502be0dc060aadf755d1877aa69c98e98e9029d090cbabe4f12b9ff72343ce8358f789766b59c463d4108101a67ac6ed6e2257ba7e9835a56c67d4f90d6617a98c0ce0930812554483f7273252c63a941bc5f4185b9fd450637e2bb341614e69fe5ddb8eec3c99f7b652ef8c09277de309b6e96520bc9d7c9d6e011d9b6b0aea5ad9b48279d67731848cb6e110ca0411f36baa6ae4b8ae132b1444dc04dcb7cf118ee48a9f1e5321577a3dedc8380b41649246325b8477 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2022/01/25/web%E9%80%86%E5%90%91-%E4%B8%AD%E5%9B%BD%E4%BA%BA%E6%B0%91%E9%93%B6%E8%A1%8Cwzwschallenge%E5%8F%82%E6%95%B0/" title="web逆向-中国人民银行wzwschallenge参数.md"><img class="post_bg" src= "https://cdn.jsdelivr.net/gh/cxs1427/my_blog_files/loading.gif" data-lazy-src="https://s2.loli.net/2023/09/28/C7D2jvSzhJrscgU.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="web逆向-中国人民银行wzwschallenge参数.md"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/01/25/web%E9%80%86%E5%90%91-%E4%B8%AD%E5%9B%BD%E4%BA%BA%E6%B0%91%E9%93%B6%E8%A1%8Cwzwschallenge%E5%8F%82%E6%95%B0/" title="web逆向-中国人民银行wzwschallenge参数.md">web逆向-中国人民银行wzwschallenge参数.md</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-01-24T16:05:28.000Z" title="发表于 2022-01-25 00:05:28">2022-01-25</time></span></div><div class="content">这里无法直接使用浏览器抓包，因为相同url的包会被覆盖掉，直接上 fiddler:你如果用requests直接去请求的话，就会看到上图那一大坨混淆过后的js代码，使用的是sojson.v6版本的混淆
分析一下正常的请求流程，第二个请求很关键，主要是构建正确的 wzwschallenge参数，然后拼接url，才能拿到返回的 set-cookie
网站使用的是 CWAP-WAF服务，随手百度了一下，是中国电子云的一个防火墙服务
那么 wzwschallenge从哪里来呢，看了一下，网站没有其他的js请求，那么肯定就是从开头那一大坨混淆后的js代码里生成的，混淆后的代码太难看了，用AST插件还原一波
定位到这里分析了一下，主要是和 _0x13698a、_0xcff1b8两个函数有关，两个函数代码量也不大，我就直接用python还原算法了，当然扣下来直接运行js代码也行
代码整理1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2022/01/25/web%E9%80%86%E5%90%91-%E7%9C%8B%E6%9F%90%E7%BD%91%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%8A%A0%E5%AF%86%E5%88%86%E6%9E%90/" title="web逆向-看某网微信小程序加密分析"><img class="post_bg" src= "https://cdn.jsdelivr.net/gh/cxs1427/my_blog_files/loading.gif" data-lazy-src="https://s2.loli.net/2023/09/28/XY4T5hLuVczKoiq.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="web逆向-看某网微信小程序加密分析"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/01/25/web%E9%80%86%E5%90%91-%E7%9C%8B%E6%9F%90%E7%BD%91%E5%BE%AE%E4%BF%A1%E5%B0%8F%E7%A8%8B%E5%BA%8F%E5%8A%A0%E5%AF%86%E5%88%86%E6%9E%90/" title="web逆向-看某网微信小程序加密分析">web逆向-看某网微信小程序加密分析</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-01-24T16:03:55.000Z" title="发表于 2022-01-25 00:03:55">2022-01-25</time></span></div><div class="content">抓包分析目标是某招聘类小程序的面试经验数据：通过观察Fiddler 抓到的数据包，我们可以看到这款小程序对两个地方进行了加密，一个是请求参数 QueryString 里面的 b 和 kiv：一个是 Response 里面的文本数据：由于小程序没有像PC端那样有js文件渲染，所以推断是内部的wxapkg文件对数据进行的加解密，因此就需要反编译获取小程序的源码，再进行静态调试分析算法。
源码获取wxapkg文件的获取PC端微信的小程序包缓存路径，一般为 .\WeChat Files\Applet，里面每个 wx 开头的文件夹代表一个小程序，为了锁定目标的小程序，可以先清空 Applet 目录，然后打开小程序，找到目录下唯一的 wx 文件夹，主包 __APP__.wxapkg 就是我们要分析的对象了
反编译（参考链接）反编译前，使用UnpackMiniApp.exe对小程序包进行解密

如果提示安装 Framwork 3.5 失败，重启电脑即可

解密前，需要在根目录下创建好 wxpack 文件夹，不然会报错


接下来就是对解密后的包文件反编译了，cmd打开命令窗口， 进入到 wxappU ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2022/01/24/Python%E7%BC%96%E7%A8%8B-html%E6%BA%90%E7%A0%81%E5%8E%8B%E7%BC%A9/" title="Python编程-html源码压缩"><img class="post_bg" src= "https://cdn.jsdelivr.net/gh/cxs1427/my_blog_files/loading.gif" data-lazy-src="https://s2.loli.net/2023/09/28/l1oxC2YHL9raeT3.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Python编程-html源码压缩"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/01/24/Python%E7%BC%96%E7%A8%8B-html%E6%BA%90%E7%A0%81%E5%8E%8B%E7%BC%A9/" title="Python编程-html源码压缩">Python编程-html源码压缩</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-01-24T15:17:09.000Z" title="发表于 2022-01-24 23:17:09">2022-01-24</time></span></div><div class="content">用爬虫抓下来的html源码，一般都有很多 换行符和空格，现在想实现一个效果，对这些空字符都去掉，也就是对源码做一个压缩
第一时间可能是想到用正则去掉：

new_txt = re.sub(r”&gt;\s+&lt;”, “&gt;&lt;”, text)

这样做的坏处是，假如标签的纯文本中存在模式类似 “&gt;\s+&lt;” 的文本，原本的结构就被破坏了，因此最好不要用正则直接去修改 html源码，很容易造成误差
逛了一圈 stockflow，我找到一个方案，就是使用 lxml.etree遍历每个标签节点，对其中的 tail和text 做一个 strip操作，我封装成了一个函数：
12345678910from lxml import etree def remove_tag_space(html_text):	tree = etree.HTML(html_text)	for tag in tree.iter():		if tag.tail:			tag.tail = tag.tail.strip()		if tag.text:			tag.text = tag.text.str ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2022/01/24/%E7%88%AC%E8%99%AB%E5%B7%A5%E7%A8%8B%E5%B8%88-css%E9%80%89%E6%8B%A9%E5%99%A8%E8%AF%AD%E6%B3%95%E6%80%BB%E7%BB%93/" title="爬虫工程师-css选择器语法总结"><img class="post_bg" src= "https://cdn.jsdelivr.net/gh/cxs1427/my_blog_files/loading.gif" data-lazy-src="https://s2.loli.net/2023/09/28/fo2BWlrjUOvdnLS.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="爬虫工程师-css选择器语法总结"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/01/24/%E7%88%AC%E8%99%AB%E5%B7%A5%E7%A8%8B%E5%B8%88-css%E9%80%89%E6%8B%A9%E5%99%A8%E8%AF%AD%E6%B3%95%E6%80%BB%E7%BB%93/" title="爬虫工程师-css选择器语法总结">爬虫工程师-css选择器语法总结</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-01-24T14:40:17.000Z" title="发表于 2022-01-24 22:40:17">2022-01-24</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/%E9%80%89%E6%8B%A9%E5%99%A8/">选择器</a></span></div><div class="content">HTML文本转DOM树的两种方式
使用lxml.etree1234from lxml import etree html = etree.HTML(html_text)html.xpath(&quot;//div[@class=&#x27;tabslider&#x27;]/ul&quot;)


使用scrapy团队开源的parsel库（推荐），Parsel官方文档12345678910111213141516171819202122from parsel import Selector # 构建DOM树，可解析html文本和xml文本html = Selector(text=html_text or xml_text) # 解析结果的获取和处理# 返回单个字符串html.xpath(&quot;...&quot;).get()html.xpath(&quot;...&quot;).extract_first() # 返回结果列表html.xpath(&quot;...&quot;).getall()html.xpath(&quot;...&quot;).extract() # 获取节 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2022/01/24/Python%E7%BC%96%E7%A8%8B-%E5%AE%9E%E7%94%A8%E6%8A%80%E5%B7%A7%EF%BC%88%E4%B8%80%EF%BC%89/" title="Python编程技巧（一）"><img class="post_bg" src= "https://cdn.jsdelivr.net/gh/cxs1427/my_blog_files/loading.gif" data-lazy-src="https://s2.loli.net/2023/09/28/vcDPi9YnKjhJABX.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Python编程技巧（一）"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/01/24/Python%E7%BC%96%E7%A8%8B-%E5%AE%9E%E7%94%A8%E6%8A%80%E5%B7%A7%EF%BC%88%E4%B8%80%EF%BC%89/" title="Python编程技巧（一）">Python编程技巧（一）</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-01-24T10:12:14.000Z" title="发表于 2022-01-24 18:12:14">2022-01-24</time></span><span class="article-meta"><span class="article-meta-separator">|</span><i class="fas fa-inbox"></i><a class="article-meta__categories" href="/categories/python%E6%95%99%E7%A8%8B/">python教程</a></span></div><div class="content">方便一些包的导入1234# 把当前目录、父目录、父fusys.path.append(os.path.abspath(&quot;../..&quot;))  sys.path.append(os.path.abspath(&quot;..&quot;))sys.path.append(os.path.abspath(&quot;.&quot;))



字符填充12345678In [1]: &quot;cxs&quot;.ljust(16, &quot;0&quot;)Out[1]: &#x27;cxs0000000000000&#x27;In [2]: &quot;cxs&quot;.center(16, &quot;0&quot;)Out[2]: &#x27;000000cxs0000000&#x27;In [3]: &quot;cxs&quot;.rjust(16, &quot;0&quot;)Out[3]: &#x27;0000000000000cxs&#x27;



tuple拆包1234t = (&#x27;cxs&#x27;,16,2,3)name, *num =  ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2022/01/24/%E7%88%AC%E8%99%AB%E5%B7%A5%E7%A8%8B%E5%B8%88-%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7%E7%BD%91%E7%AB%99/" title="爬虫工程师-常用工具网站"><img class="post_bg" src= "https://cdn.jsdelivr.net/gh/cxs1427/my_blog_files/loading.gif" data-lazy-src="https://s2.loli.net/2023/09/28/Wez9pB5fxCobQV3.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="爬虫工程师-常用工具网站"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/01/24/%E7%88%AC%E8%99%AB%E5%B7%A5%E7%A8%8B%E5%B8%88-%E5%B8%B8%E7%94%A8%E5%B7%A5%E5%85%B7%E7%BD%91%E7%AB%99/" title="爬虫工程师-常用工具网站">爬虫工程师-常用工具网站</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-01-24T10:11:15.000Z" title="发表于 2022-01-24 18:11:15">2022-01-24</time></span></div><div class="content">实用的爬虫工具库
大佬开源的工具库，非常使用，包含如下功能：（终于不用自己傻傻地写宏了）


JSON格式化
Header格式化
Cookie格式化
Dict格式化
JS格式化
HTML格式化
curl转requests
curl转feapder
url参数提取
url编码
url解码
html渲染
文本解码
文本对比
时间转换
加解密
代码分享

猿人学ob解混淆工具
只能解ob混淆，遇到其他混淆建议使用AST插件，后面会介绍

de4js
全称是 JavaScript Deobfuscator and Unpacker，一位越南大神开源的js解混淆工具，网站风格很酷，可解类型包括：


Eval, e.g. Packer, WiseLoop
Array, e.g. Javascript Obfuscator, Free JS Obfuscator
_Number (not correct name)
Packer
Javascript Obfuscator
Free JS Obfuscator
Obfuscator.IO (but not all cases)
My Obfusca ...</div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/7/#content-inner"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/7/#content-inner">7</a><span class="page-number current">8</span><a class="page-number" href="/page/9/#content-inner">9</a><a class="extend next" rel="next" href="/page/9/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "https://cdn.jsdelivr.net/gh/cxs1427/my_blog_files/loading.gif" data-lazy-src="https://s2.loli.net/2023/06/28/qRyt6e5NoVs4cdD.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Chen Xs</div><div class="author-info__description"></div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">82</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">19</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/cxs1427" target="_blank" title="Github"><i class="fab fa-github"></i></a></div></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/01/28/%E4%BA%AC%E4%B8%9Cm%E7%AB%AFh5st%E9%80%86%E5%90%91/" title="京东m端h5st逆向"><img src= "https://cdn.jsdelivr.net/gh/cxs1427/my_blog_files/loading.gif" data-lazy-src="https://s2.loli.net/2023/09/28/VOJf1QrHL2gl9X4.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="京东m端h5st逆向"/></a><div class="content"><a class="title" href="/2024/01/28/%E4%BA%AC%E4%B8%9Cm%E7%AB%AFh5st%E9%80%86%E5%90%91/" title="京东m端h5st逆向">京东m端h5st逆向</a><time datetime="2024-01-27T16:37:47.000Z" title="发表于 2024-01-28 00:37:47">2024-01-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/01/05/%E5%B0%8F%E8%82%A9%E8%86%80js%E8%A1%A5%E7%8E%AF%E5%A2%83%E8%AF%BE%E7%A8%8B/" title="小肩膀js补环境课程"><img src= "https://cdn.jsdelivr.net/gh/cxs1427/my_blog_files/loading.gif" data-lazy-src="https://s2.loli.net/2023/09/28/l1oxC2YHL9raeT3.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="小肩膀js补环境课程"/></a><div class="content"><a class="title" href="/2024/01/05/%E5%B0%8F%E8%82%A9%E8%86%80js%E8%A1%A5%E7%8E%AF%E5%A2%83%E8%AF%BE%E7%A8%8B/" title="小肩膀js补环境课程">小肩膀js补环境课程</a><time datetime="2024-01-05T10:03:40.000Z" title="发表于 2024-01-05 18:03:40">2024-01-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/12/10/docker%E7%AC%94%E8%AE%B0/" title="docker学习笔记"><img src= "https://cdn.jsdelivr.net/gh/cxs1427/my_blog_files/loading.gif" data-lazy-src="https://s2.loli.net/2023/09/28/vcDPi9YnKjhJABX.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="docker学习笔记"/></a><div class="content"><a class="title" href="/2023/12/10/docker%E7%AC%94%E8%AE%B0/" title="docker学习笔记">docker学习笔记</a><time datetime="2023-12-09T22:42:39.000Z" title="发表于 2023-12-10 06:42:39">2023-12-10</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/12/07/%E6%B5%B7%E5%A4%96%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%E6%B1%87%E6%80%BB/" title="海外数据采集汇总"><img src= "https://cdn.jsdelivr.net/gh/cxs1427/my_blog_files/loading.gif" data-lazy-src="https://s2.loli.net/2023/09/28/rYJHbGxS9yDacLu.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="海外数据采集汇总"/></a><div class="content"><a class="title" href="/2023/12/07/%E6%B5%B7%E5%A4%96%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%E6%B1%87%E6%80%BB/" title="海外数据采集汇总">海外数据采集汇总</a><time datetime="2023-12-07T03:54:45.000Z" title="发表于 2023-12-07 11:54:45">2023-12-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2023/10/26/python%E7%BC%96%E7%A8%8B%E6%8A%80%E5%B7%A7%E5%9B%9B/" title="python编程技巧（四）"><img src= "https://cdn.jsdelivr.net/gh/cxs1427/my_blog_files/loading.gif" data-lazy-src="https://s2.loli.net/2023/09/28/Fs8u7mwTRkEUqAN.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="python编程技巧（四）"/></a><div class="content"><a class="title" href="/2023/10/26/python%E7%BC%96%E7%A8%8B%E6%8A%80%E5%B7%A7%E5%9B%9B/" title="python编程技巧（四）">python编程技巧（四）</a><time datetime="2023-10-26T08:13:29.000Z" title="发表于 2023-10-26 16:13:29">2023-10-26</time></div></div></div></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">82</div></div><div class="webinfo-item"><div class="item-name">本站总字数 :</div><div class="item-count">85.8k</div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2024-02-11T14:37:23.822Z"></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><!-- if theme.footer.owner.since && theme.footer.owner.since != nowYear// .copyright!= `&copy;${theme.footer.owner.since} - ${nowYear} By ${config.author}`--><!-- else--><div class="copyright">&copy;某年某月 <i class='fas fa-bug fa-spin'></i> By Chen Xs</div><!-- if theme.footer.copyright// .framework-info
  // span= _p('footer.framework') + ' '
  // a(href='https://hexo.io')= 'Hexo'
  // span.footer-separator |
  // span= _p('footer.theme') + ' '
  // a(href='https://github.com/jerryc127/hexo-theme-butterfly')= 'Butterfly'--><!-- if theme.footer.custom_text// .footer_custom_text!=`${theme.footer.custom_text}`
--></div><div class="container" id="jsi-flying-fish-container"><script src="/js/fish.js"></script></div><style>   @media only screen and (max-width: 767px){
   #sidebar_search_box input[type=text]{width:calc(100% - 24px)}
}</style></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><div class="js-pjax"><script>function subtitleType () {
  if (true) { 
    window.typed = new Typed("#subtitle", {
      strings: ["天意昭炯，我自独行","天地虽不容我，心安即是归处"],
      startDelay: 300,
      typeSpeed: 150,
      loop: true,
      backSpeed: 50
    })
  } else {
    document.getElementById("subtitle").innerHTML = '天意昭炯，我自独行'
  }
}

if (true) {
  if (typeof Typed === 'function') {
    subtitleType()
  } else {
    getScript('https://cdn.jsdelivr.net/npm/typed.js/lib/typed.min.js').then(subtitleType)
  }
} else {
  subtitleType()
}</script></div><script src="/js/fish_jquery.js"></script><script src="/js/chocolate.js"></script><script src="/js/fish.js"></script><div class="aplayer no-destroy" data-id="3145079790" data-server="netease" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="false" muted></div><canvas class="fireworks" mobile="true"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = true;
document.body.addEventListener('input', POWERMODE);
</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/SerokSSR/cdn/meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  typeof preloader === 'object' && preloader.initLoading()
  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --><script type="text/javascript">var font='Computerfont'</script><script data-pjax>function electric_clock_injector_config(){
                var parent_div_git = document.getElementsByClassName('sticky_layout')[0];
                var item_html = '<div class="card-widget card-clock"><div class="card-glass"><div class="card-background"><div class="card-content"><div id="hexo_electric_clock"><img id="card-clock-loading" src= "https://cdn.jsdelivr.net/gh/cxs1427/my_blog_files/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/Zfour/Butterfly-clock/clock/images/weather/loading.gif" style="height: 120px; width: 100%;" data-ll-status="loading" class="entered loading"></div></div></div></div></div>';
                console.log('已挂载electric_clock')
                // parent_div_git.innerHTML=item_html+parent_div_git.innerHTML // 无报错，但不影响使用(支持pjax跳转)
                parent_div_git.insertAdjacentHTML("afterbegin",item_html) // 有报错，但不影响使用(支持pjax跳转)
            }if( document.getElementsByClassName('sticky_layout')[0] && (location.pathname ==='all'|| 'all' ==='all')){

            electric_clock_injector_config()
        } </script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script>
        <script type="text/javascript">
            loc = $.ajax({
                    url: "https://ipapi.co/json/",  //json文件位置，文件名
                    type: "GET",                    //请求方式为get
                    dataType: "json",               //返回数据格式为json
                    async: false,
                    success: function(data) {       //请求成功完成后要执行的方法 
                    }
                });
            ip=$.parseJSON(loc.responseText).ip;
            version=$.parseJSON(loc.responseText).version;
            city=$.parseJSON(loc.responseText).city;
            country=$.parseJSON(loc.responseText).country_name;
        </script>
        <script data-pjax src="https://cdn.jsdelivr.net/npm/hexo-electric-clock-plus@latest/js/clock.js"></script><script data-pjax>
  function butterfly_footer_beautify_injector_config(){
    var parent_div_git = document.getElementById('footer-wrap');
    var item_html = '<p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="博客框架为Hexo" title=""><img src= "https://cdn.jsdelivr.net/gh/cxs1427/my_blog_files/loading.gif" data-lazy-src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&amp;logo=hexo" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" data-title="主题为Butterfly" title=""><img src= "https://cdn.jsdelivr.net/gh/cxs1427/my_blog_files/loading.gif" data-lazy-src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&amp;logo=bitdefender" alt=""/></a><a class="github-badge" target="_blank" href="https://www.jsdelivr.com/" style="margin-inline:5px" data-title="本站使用JsDelivr为静态资源提供CDN加速" title=""><img src= "https://cdn.jsdelivr.net/gh/cxs1427/my_blog_files/loading.gif" data-lazy-src="https://img.shields.io/badge/CDN-jsDelivr-orange?style=flat&amp;logo=jsDelivr" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" data-title="本站项目由Github托管" title=""><img src= "https://cdn.jsdelivr.net/gh/cxs1427/my_blog_files/loading.gif" data-lazy-src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&amp;logo=GitHub" alt=""/></a></p>';
    console.log('已挂载butterfly_footer_beautify')
    parent_div_git.insertAdjacentHTML("beforeend",item_html)
    }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_footer_beautify_injector_config();
  }
  else if (epage === cpage){
    butterfly_footer_beautify_injector_config();
  }
  </script><!-- hexo injector body_end end --></body></html>