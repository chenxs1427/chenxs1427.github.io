<!DOCTYPE html><html lang="zh-CN" data-theme="dark"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>Chen's Blog</title><meta name="author" content="Chen Xs"><meta name="copyright" content="Chen Xs"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#0d0d0d"><meta property="og:type" content="website">
<meta property="og:title" content="Chen&#39;s Blog">
<meta property="og:url" content="https://chenxs1427.github.io/page/3/index.html">
<meta property="og:site_name" content="Chen&#39;s Blog">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s2.loli.net/2023/06/28/qRyt6e5NoVs4cdD.jpg">
<meta property="article:author" content="Chen Xs">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s2.loli.net/2023/06/28/qRyt6e5NoVs4cdD.jpg"><link rel="shortcut icon" href="https://s2.loli.net/2023/04/15/3vnNmAl8Yxa5EIK.png"><link rel="canonical" href="https://chenxs1427.github.io/page/3/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"limitCount":50,"languages":{"author":"作者: Chen Xs","link":"链接: ","source":"来源: Chen's Blog","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery@2/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Chen\'s Blog',
  isPost: false,
  isHome: true,
  isHighlightShrink: false,
  isToc: false,
  postUpdate: '2024-10-09 09:48:02'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><link rel="stylesheet" href="/css/background.css"><link rel="stylesheet" href="/css/custom.css" media="defer" onload="this.media='all'"><!-- hexo injector head_end start --><link rel="stylesheet" href="https://unpkg.zhimg.com/hexo-butterfly-footer-beautify@1.0.0/lib/runtime.css" media="print" onload="this.media='all'"><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.0.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "https://cdn.jsdelivr.net/gh/cxs1427/my_blog_files/loading.gif" data-lazy-src="https://s2.loli.net/2023/06/28/qRyt6e5NoVs4cdD.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data is-center"><div class="data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">90</div></a></div><div class="data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">19</div></a></div><div class="data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/cat/"><i class="fa-fw fas fa-regular fa-cat fa-bounce"></i><span> 喵喵</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 生活</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/books/"><i class="fa-fw fas fa-book"></i><span> 读书</span></a></li><li><a class="site-page child" href="/cooks/"><i class="fa-fw fas fa-utensils"></i><span> 厨艺</span></a></li><li><a class="site-page child" href="/cinemas/"><i class="fa-fw fas fa-mountain"></i><span> 追剧</span></a></li><li><a class="site-page child" href="/bangumis/"><i class="fa-fw fas fa-yin-yang"></i><span> 追番</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></div><div class="menus_item"><a class="site-page" href="/games/"><i class="fa-fw fas fa-sign-language"></i><span> 游戏</span></a></div><div class="menus_item"><a class="site-page" href="/college-poems/"><i class="fa-fw fas fa-fire"></i><span> 诗选</span></a></div><div class="menus_item"><a class="site-page" href="/car3/"><i class="fa-fw fas fa-car"></i><span> 科目三</span></a></div></div></div></div><div class="page" id="body-wrap"><header class="full_page" id="page-header" style="background-image: url('https://s2.loli.net/2023/06/28/TeGHI4W1UuqSXDg.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Chen's Blog</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/cat/"><i class="fa-fw fas fa-regular fa-cat fa-bounce"></i><span> 喵喵</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fas fa-list"></i><span> 生活</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/books/"><i class="fa-fw fas fa-book"></i><span> 读书</span></a></li><li><a class="site-page child" href="/cooks/"><i class="fa-fw fas fa-utensils"></i><span> 厨艺</span></a></li><li><a class="site-page child" href="/cinemas/"><i class="fa-fw fas fa-mountain"></i><span> 追剧</span></a></li><li><a class="site-page child" href="/bangumis/"><i class="fa-fw fas fa-yin-yang"></i><span> 追番</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/movies/"><i class="fa-fw fas fa-video"></i><span> 电影</span></a></div><div class="menus_item"><a class="site-page" href="/games/"><i class="fa-fw fas fa-sign-language"></i><span> 游戏</span></a></div><div class="menus_item"><a class="site-page" href="/college-poems/"><i class="fa-fw fas fa-fire"></i><span> 诗选</span></a></div><div class="menus_item"><a class="site-page" href="/car3/"><i class="fa-fw fas fa-car"></i><span> 科目三</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="site-info"><h1 id="site-title">Chen's Blog</h1><div id="site-subtitle"><span id="subtitle"></span></div></div><div id="scroll-down"><i class="fas fa-angle-down scroll-down-effects"></i></div></header><main class="layout" id="content-inner"><div class="recent-posts" id="recent-posts"><div class="recent-post-item"><div class="post_cover left"><a href="/2023/05/16/%E4%BA%AC%E4%B8%9Ch5st%E5%8F%82%E6%95%B0%E9%80%86%E5%90%91/" title="京东web商品详情接口h5st参数逆向，补环境和纯python实现"><img class="post_bg" src= "https://cdn.jsdelivr.net/gh/cxs1427/my_blog_files/loading.gif" data-lazy-src="https://s2.loli.net/2023/09/28/89uh6qrbl3eIAPf.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="京东web商品详情接口h5st参数逆向，补环境和纯python实现"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/05/16/%E4%BA%AC%E4%B8%9Ch5st%E5%8F%82%E6%95%B0%E9%80%86%E5%90%91/" title="京东web商品详情接口h5st参数逆向，补环境和纯python实现">京东web商品详情接口h5st参数逆向，补环境和纯python实现</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-05-16T08:12:31.000Z" title="发表于 2023-05-16 16:12:31">2023-05-16</time></span></div><div class="content">
  0701657335e84f0c327f6bba26337f2a0d6e037a5905cf83130fe2c68e5b9ab86701528920ae9126f98513315f17b82af70de4676511670b9e6f5c284bf323264f87010c64bc81d28337512d0e4f292b4a80e74426960ee92b93f4bdef3eb2ec48753599128bff1f7ba4626961bb45921801e4a4aec67a4e64e6dbec86699f3faaa22744587fa9503c5e0ae3ddd16434726e617e657ad5849f0742cab8954e9ad0e3497d8cd1bc6abd45730bd6bcb5e6d396e8063e9fb0f0d908370b16c26ec1e5b42e2ef38b5292e7856d20d27c9f5512b7da82e4b21e259c789823aa70bfcdb266baba8f717c8132a10834d72f5e97293aaed75cf81acda ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2023/04/30/%E6%8A%96%E9%9F%B3%E5%BC%B9%E5%B9%95/" title="抖音弹幕 WebSocket协议、Protobuf还原"><img class="post_bg" src= "https://cdn.jsdelivr.net/gh/cxs1427/my_blog_files/loading.gif" data-lazy-src="https://s2.loli.net/2023/09/28/UxVXREhTNmujDSF.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="抖音弹幕 WebSocket协议、Protobuf还原"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/04/30/%E6%8A%96%E9%9F%B3%E5%BC%B9%E5%B9%95/" title="抖音弹幕 WebSocket协议、Protobuf还原">抖音弹幕 WebSocket协议、Protobuf还原</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-04-29T20:25:34.000Z" title="发表于 2023-04-30 04:25:34">2023-04-30</time></span></div><div class="content">
  0701657335e84f0c327f6bba26337f2ad6ca4ba8e3335a3698f9be1e4802627df9bf1ba2016982363085a7a4c7e66d36234dd0b01c29f69d016d230846f0fd4b40c30d5716eee2f541bd5d1e879c29027be824d015e44112c6e27924c2302991dd191658d151192c8c8d1cff6118c20a7df51a3c6acd0446304df202cfc77965d0361b83a24498faf7ab736cfd4e6e9d46743ea4634b84c17e7fdb542e3e9a5ce916be2c5c5e138168f04de241c95a936271238e40ab963a5135efac38bffbcab2066d23a6ead6884453f10a9a5a8c6d2ec8f41da38eb882b7d6627cb752a1c8f8beaae5d35e297ac24ff34a15b4cf560a7384be1065497ad ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2023/02/07/APP%E9%80%86%E5%90%91-%E5%90%BE%E7%88%B1%E7%A0%B4%E8%A7%A3%E5%AE%89%E5%8D%93%E4%B8%AD%E7%BA%A7%E9%A2%98%EF%BC%8C%E6%9D%A5%E7%82%B9%E5%B0%8F%E5%B0%8F%E7%9A%84CTF%E9%9C%87%E6%92%BC/" title="APP逆向-吾爱破解2023安卓中级题，来点小小的CTF震撼"><img class="post_bg" src= "https://cdn.jsdelivr.net/gh/cxs1427/my_blog_files/loading.gif" data-lazy-src="https://s2.loli.net/2023/09/28/KZQxTAaudgzkFly.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="APP逆向-吾爱破解2023安卓中级题，来点小小的CTF震撼"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/02/07/APP%E9%80%86%E5%90%91-%E5%90%BE%E7%88%B1%E7%A0%B4%E8%A7%A3%E5%AE%89%E5%8D%93%E4%B8%AD%E7%BA%A7%E9%A2%98%EF%BC%8C%E6%9D%A5%E7%82%B9%E5%B0%8F%E5%B0%8F%E7%9A%84CTF%E9%9C%87%E6%92%BC/" title="APP逆向-吾爱破解2023安卓中级题，来点小小的CTF震撼">APP逆向-吾爱破解2023安卓中级题，来点小小的CTF震撼</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-02-07T06:37:10.000Z" title="发表于 2023-02-07 14:37:10">2023-02-07</time></span></div><div class="content">先来看看APP界面

拖到jadx，see see  java 源码

关键是要让代码跳转到这里，我这里主要是修改smali，然后重新签名打包，当然，你也可以用frida或者objection hook 传参

模仿下面的两行代码，在位置1插入
12:cond_63:goto_63

然后，修改上面的两个if判断，重新打包，跳转成功

过了这个，但还是啥都没有，只跳出一句话，再看源码，注意到两处可疑的地方


将apk改成压缩包，在里面找到  aes.png 和 lib52pj.so 两个文件
先以文本形式打开 aes.png，得到一大段意义不明的文本

有点像是base64编码，decode一下

还是不明所以，先放一边……💀💀💀
再来分析so，拖到 IDA Pro 分析

进入 Java_com_zj_wuaipojie2023_12_MainActivity_decrypt 函数内部


这里可以确定加密算法是AES，模式是ECB，填充是PKCS7，|wfkuqokj4548366 刚好16位长度，疑似密钥
到**CyberChef**试试就知道了，显示参数出错，果然没那么 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2023/01/26/APP%E9%80%86%E5%90%91-%E4%BF%AE%E6%94%B9apk/" title="APP逆向-戒了吧去除开屏广告和强制更新"><img class="post_bg" src= "https://cdn.jsdelivr.net/gh/cxs1427/my_blog_files/loading.gif" data-lazy-src="https://s2.loli.net/2023/09/28/Jhzi9n14lrvumBQ.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="APP逆向-戒了吧去除开屏广告和强制更新"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/01/26/APP%E9%80%86%E5%90%91-%E4%BF%AE%E6%94%B9apk/" title="APP逆向-戒了吧去除开屏广告和强制更新">APP逆向-戒了吧去除开屏广告和强制更新</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-01-26T13:15:42.000Z" title="发表于 2023-01-26 21:15:42">2023-01-26</time></span></div><div class="content">去除更新弹窗方法一  修改 AndroidManifest.xml 版本号（失败）
方法二  修改 dex 版本号（失败）
方法三 抓包分析接口（失败）死活找不到入口，唉~

方法四 Arsc资源搜索（失败）
方法五  Activity记录MT管理器开启Activity记录，定位到 com.dcloud.android.widget.dialog.DCloudAlertDialog
删除 show

删除两个 constructor

终于成功了，我淦！！！😭
去除开屏动画（失败，应用数据读取失败）
修改 AndroidManifest.xml 里面 LAUNCHER 的 android:name
MT管理器教程第四课之去除软件更新提示_哔哩哔哩_bilibili
Android逆向技巧——去除开屏广告_Android_脚本之家
教你学会简单的APK修改
</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2023/01/25/Windows%E9%80%86%E5%90%91%E5%88%9D%E4%BD%93%E9%AA%8C/" title="Windows逆向初体验"><img class="post_bg" src= "https://cdn.jsdelivr.net/gh/cxs1427/my_blog_files/loading.gif" data-lazy-src="https://s2.loli.net/2023/09/28/S6oxyHtlQwhMKaj.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Windows逆向初体验"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/01/25/Windows%E9%80%86%E5%90%91%E5%88%9D%E4%BD%93%E9%AA%8C/" title="Windows逆向初体验">Windows逆向初体验</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-01-25T03:39:11.000Z" title="发表于 2023-01-25 11:39:11">2023-01-25</time></span></div><div class="content">如何正确的对Windows软件进行逆向工程（翻译/转载） | Lyon’s blog
Proxifier抓包PC应用，转发Fiddler参考：http://www.51testing.com/html/42/15142342-4462193.html
增加服务器： 配置文件 - 代理服务器

增加规则： 配置文件 - 代理规则

不自动解析域名

</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2023/01/25/APP%E9%80%86%E5%90%91-%E5%90%BE%E7%88%B1%E7%A0%B4%E8%A7%A32023%E6%98%A5%E8%8A%82/" title="APP逆向-吾爱破解2023春节"><img class="post_bg" src= "https://cdn.jsdelivr.net/gh/cxs1427/my_blog_files/loading.gif" data-lazy-src="https://s2.loli.net/2023/09/28/KZQxTAaudgzkFly.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="APP逆向-吾爱破解2023春节"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/01/25/APP%E9%80%86%E5%90%91-%E5%90%BE%E7%88%B1%E7%A0%B4%E8%A7%A32023%E6%98%A5%E8%8A%82/" title="APP逆向-吾爱破解2023春节">APP逆向-吾爱破解2023春节</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-01-25T03:37:37.000Z" title="发表于 2023-01-25 11:37:37">2023-01-25</time></span></div><div class="content">Android 1使用开发者助手分析界面资源


定位按钮标签


在jadx-gui中，根据包名和类名定位代码，抠出来修改一下，放到Java在线编译网站上运行，得到flag


通关 🙌🙌🙌




Android 2像第一题一样，使用开发者助手定位Activity，这里就不赘述了，直接上jadx-gui静态分析


主要的判断逻辑在这里，其实就是将uid和flag传给c0837a.m25B，然后返回结果
12345if (c0837a.m25B(obj, StringsKt.trim((CharSequence) editText2.getText().toString()).toString())) &#123;	Toast.makeText(this$0, &quot;恭喜你，flag正确!&quot;, 1).show();&#125; else &#123;	Toast.makeText(this$0, &quot;flag错误哦，再想想！&quot;, 1).show();&#125;

进入 c0837a.m25B 函数：

函数的返回结果是比较两个值
这里由于涉 ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2023/01/15/APP%E9%80%86%E5%90%91-flutter%E9%80%86%E5%90%91%E7%AC%94%E8%AE%B0/" title="APP逆向-flutter逆向笔记"><img class="post_bg" src= "https://cdn.jsdelivr.net/gh/cxs1427/my_blog_files/loading.gif" data-lazy-src="https://s2.loli.net/2023/09/28/S6oxyHtlQwhMKaj.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="APP逆向-flutter逆向笔记"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/01/15/APP%E9%80%86%E5%90%91-flutter%E9%80%86%E5%90%91%E7%AC%94%E8%AE%B0/" title="APP逆向-flutter逆向笔记">APP逆向-flutter逆向笔记</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-01-15T06:37:23.000Z" title="发表于 2023-01-15 14:37:23">2023-01-15</time></span></div><div class="content">逛了一圈发现flutter的逆向难度太大（其实还是因为我太菜了🤡），连抓个包都费劲 🐶 就像肉师傅说的


关于判断应用是否flutter开发？




这里就收集一下目前已知的情报吧，就当做积累

对flutter开发的某app逆向分析

[原创]flutter逆向助手-基于reflutter的简易化dart解析工具

[原创]Flutter概述和逆向技术发展时间线，带你快速了解

Doldrums：一款功能强大的逆向工程分析工具-51CTO.COM


</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2023/01/10/APP%E9%80%86%E5%90%91-%E7%8C%BF%E4%BA%BA%E5%AD%A6APP%E5%A4%A7%E8%B5%9B-%E7%AC%AC%E4%BA%94%E9%A2%98-%E5%8F%8C%E5%90%91%E8%AE%A4%E8%AF%81/" title="APP逆向-猿人学APP大赛-第五题-双向认证"><img class="post_bg" src= "https://cdn.jsdelivr.net/gh/cxs1427/my_blog_files/loading.gif" data-lazy-src="https://s2.loli.net/2023/09/28/386WiqQJlpI4e9E.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="APP逆向-猿人学APP大赛-第五题-双向认证"></a></div><div class="recent-post-info"><a class="article-title" href="/2023/01/10/APP%E9%80%86%E5%90%91-%E7%8C%BF%E4%BA%BA%E5%AD%A6APP%E5%A4%A7%E8%B5%9B-%E7%AC%AC%E4%BA%94%E9%A2%98-%E5%8F%8C%E5%90%91%E8%AE%A4%E8%AF%81/" title="APP逆向-猿人学APP大赛-第五题-双向认证">APP逆向-猿人学APP大赛-第五题-双向认证</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2023-01-10T08:22:37.000Z" title="发表于 2023-01-10 16:22:37">2023-01-10</time></span></div><div class="content">先理解一下什么是 双向认证  https://cloud.tencent.com/developer/article/1699532

所以用fiddler抓包是肯定不行的，用r0capture试试吧
请求，图中已经圈出了 Host、Path 和 FormData

返回

下一步就是要dump出客户端中的证书，也是用r0capture

根据提示，先打开存储权限

然后启动Spawm模式，运行命令：
1python r0capture.py -U -f com.yuanrenxue.match2022 -v

报错： process not found

怀疑是 Frida 15.1.28 的不支持 Spawm模式，换个稳定版本：12.8.0
折腾了好一会儿，才在虚拟环境装好了，这里记录一下
由于无法用pip直接安装，所以需要去pypi下载对应的安装包


然后cd到对应目录下，执行命令：python setup.py install
还需要安装旧版本的 firda-tools，pip install frida-tools==5.0.0

这样就装好了，把对应版本的frida-se ...</div></div></div><div class="recent-post-item"><div class="post_cover left"><a href="/2022/12/08/APP%E9%80%86%E5%90%91-%E7%8C%BF%E4%BA%BA%E5%AD%A6-APP%E5%A4%A7%E8%B5%9B-%E7%AC%AC%E5%9B%9B%E9%A2%98-grpc%E3%80%81r0capture%E5%88%9D%E4%BD%93%E9%AA%8C/" title="APP逆向-猿人学-APP大赛-第四题-grpc、r0capture初体验"><img class="post_bg" src= "https://cdn.jsdelivr.net/gh/cxs1427/my_blog_files/loading.gif" data-lazy-src="https://s2.loli.net/2023/09/28/89uh6qrbl3eIAPf.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="APP逆向-猿人学-APP大赛-第四题-grpc、r0capture初体验"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/12/08/APP%E9%80%86%E5%90%91-%E7%8C%BF%E4%BA%BA%E5%AD%A6-APP%E5%A4%A7%E8%B5%9B-%E7%AC%AC%E5%9B%9B%E9%A2%98-grpc%E3%80%81r0capture%E5%88%9D%E4%BD%93%E9%AA%8C/" title="APP逆向-猿人学-APP大赛-第四题-grpc、r0capture初体验">APP逆向-猿人学-APP大赛-第四题-grpc、r0capture初体验</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-12-08T08:19:05.000Z" title="发表于 2022-12-08 16:19:05">2022-12-08</time></span></div><div class="content">第一步肯定还是抓包，这里不能用fiddler，因为不是http协议，刚好试一下r0captcha，使用教程可以参考：
frida+r0capture安卓应用层抓包通杀 – N_schema
先启动firda-server，配置接口转发，然后 frida-ps -R 确认连接
没问题后，切换到r0capture目录，运行命令
1python r0capture.py -U -f com.yuanrenxue.match2022 -v -p yuanrenxue_20230105.pcap

就会自动启动目标app了，观察日志：

发送包



数据包


也可以把保存的 yuanrenxue_20230105.pcap 文件拖进 wireshark 分析

发送包



数据包


这里可以先确认发送包的几点信息

host为：180.76.60.244:9901
路径为：/challenge.Challenge/SayHello
提交数据：a2f25d9111c3f20c

hook一下ChallengeFourFragment的sign函数，然后对比抓包结果：
12345678910 ...</div></div></div><div class="recent-post-item"><div class="post_cover right"><a href="/2022/10/06/Python%E7%BC%96%E7%A8%8B-%E6%89%A7%E8%A1%8CJava%E4%BB%A3%E7%A0%81%E7%9A%84%E4%B8%A4%E7%A7%8D%E6%96%B9%E5%BC%8F/" title="Python编程-执行Java代码的两种方式"><img class="post_bg" src= "https://cdn.jsdelivr.net/gh/cxs1427/my_blog_files/loading.gif" data-lazy-src="https://s2.loli.net/2023/09/28/Fs8u7mwTRkEUqAN.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Python编程-执行Java代码的两种方式"></a></div><div class="recent-post-info"><a class="article-title" href="/2022/10/06/Python%E7%BC%96%E7%A8%8B-%E6%89%A7%E8%A1%8CJava%E4%BB%A3%E7%A0%81%E7%9A%84%E4%B8%A4%E7%A7%8D%E6%96%B9%E5%BC%8F/" title="Python编程-执行Java代码的两种方式">Python编程-执行Java代码的两种方式</a><div class="article-meta-wrap"><span class="post-meta-date"><i class="far fa-calendar-alt"></i><span class="article-meta-label">发表于</span><time datetime="2022-10-06T12:35:10.000Z" title="发表于 2022-10-06 20:35:10">2022-10-06</time></span></div><div class="content">Java环境配置和执行js代码需要先在本地配好node一样，执行java代码，需要先在本地安装Java
安装步骤可以参考：https://blog.csdn.net/m0_61961937/article/details/122906540
安装好后需要配置系统环境，直接把 \JDK xx.x.x\bin 配进 path 就行
配好后，运行 java 或 javac 命令，显示如下就表示成功：

Jpype简介这里我们使用 jpype 进行调用，pypi的介绍如下：

JPype is a Python module to provide full access to Java from within Python. It allows Python to make use of Java only libraries, exploring and visualization of Java structures, development and testing of Java libraries, scientific computing, and much more. By gai ...</div></div></div><nav id="pagination"><div class="pagination"><a class="extend prev" rel="prev" href="/page/2/#content-inner"><i class="fas fa-chevron-left fa-fw"></i></a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/#content-inner">2</a><span class="page-number current">3</span><a class="page-number" href="/page/4/#content-inner">4</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/#content-inner">9</a><a class="extend next" rel="next" href="/page/4/#content-inner"><i class="fas fa-chevron-right fa-fw"></i></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "https://cdn.jsdelivr.net/gh/cxs1427/my_blog_files/loading.gif" data-lazy-src="https://s2.loli.net/2023/06/28/qRyt6e5NoVs4cdD.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Chen Xs</div><div class="author-info__description"></div></div><div class="card-info-data is-center"><div class="card-info-data-item"><a href="/archives/"><div class="headline">文章</div><div class="length-num">90</div></a></div><div class="card-info-data-item"><a href="/tags/"><div class="headline">标签</div><div class="length-num">19</div></a></div><div class="card-info-data-item"><a href="/categories/"><div class="headline">分类</div><div class="length-num">6</div></a></div></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/chenxs1427"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="sticky_layout"><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/09/02/PlayWright%E4%BD%BF%E7%94%A8%E7%AC%94%E8%AE%B0/" title="PlayWright使用笔记"><img src= "https://cdn.jsdelivr.net/gh/cxs1427/my_blog_files/loading.gif" data-lazy-src="https://s2.loli.net/2023/09/28/EwX1k3UA6lrnP5R.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="PlayWright使用笔记"/></a><div class="content"><a class="title" href="/2024/09/02/PlayWright%E4%BD%BF%E7%94%A8%E7%AC%94%E8%AE%B0/" title="PlayWright使用笔记">PlayWright使用笔记</a><time datetime="2024-09-02T10:13:04.000Z" title="发表于 2024-09-02 18:13:04">2024-09-02</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/07/27/%E9%AA%87%E5%AE%A2%E6%94%BB%E9%98%B2%E5%AE%9E%E6%88%98/" title="骇客攻防实战"><img src= "https://cdn.jsdelivr.net/gh/cxs1427/my_blog_files/loading.gif" data-lazy-src="https://s2.loli.net/2023/09/28/WAwr7BMZqCey1XN.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="骇客攻防实战"/></a><div class="content"><a class="title" href="/2024/07/27/%E9%AA%87%E5%AE%A2%E6%94%BB%E9%98%B2%E5%AE%9E%E6%88%98/" title="骇客攻防实战">骇客攻防实战</a><time datetime="2024-07-26T21:24:29.000Z" title="发表于 2024-07-27 05:24:29">2024-07-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/07/24/%E5%AE%89%E5%8D%93APP%E9%80%86%E5%90%91%E5%AE%9E%E6%88%98%E5%90%88%E9%9B%86/" title="APP逆向实战合集"><img src= "https://cdn.jsdelivr.net/gh/cxs1427/my_blog_files/loading.gif" data-lazy-src="https://s2.loli.net/2023/09/28/K4loqcRHTkvXIE1.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="APP逆向实战合集"/></a><div class="content"><a class="title" href="/2024/07/24/%E5%AE%89%E5%8D%93APP%E9%80%86%E5%90%91%E5%AE%9E%E6%88%98%E5%90%88%E9%9B%86/" title="APP逆向实战合集">APP逆向实战合集</a><time datetime="2024-07-24T09:14:17.000Z" title="发表于 2024-07-24 17:14:17">2024-07-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/07/24/%E7%91%9E%E6%95%B0%E5%9B%9B%E4%BB%A3%E9%80%86%E5%90%91/" title="瑞数5逆向"><img src= "https://cdn.jsdelivr.net/gh/cxs1427/my_blog_files/loading.gif" data-lazy-src="https://s2.loli.net/2023/09/28/W21vGjwYlnxpDEJ.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="瑞数5逆向"/></a><div class="content"><a class="title" href="/2024/07/24/%E7%91%9E%E6%95%B0%E5%9B%9B%E4%BB%A3%E9%80%86%E5%90%91/" title="瑞数5逆向">瑞数5逆向</a><time datetime="2024-07-24T09:13:45.000Z" title="发表于 2024-07-24 17:13:45">2024-07-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/07/20/%E4%B8%80%E4%BA%9B%E5%B7%A5%E5%85%B7%E5%92%8C%E7%BD%91%E7%AB%99%E6%94%B6%E8%97%8F/" title="一些工具和网站收藏"><img src= "https://cdn.jsdelivr.net/gh/cxs1427/my_blog_files/loading.gif" data-lazy-src="https://s2.loli.net/2023/09/28/WncUYtaiN8yzKEr.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="一些工具和网站收藏"/></a><div class="content"><a class="title" href="/2024/07/20/%E4%B8%80%E4%BA%9B%E5%B7%A5%E5%85%B7%E5%92%8C%E7%BD%91%E7%AB%99%E6%94%B6%E8%97%8F/" title="一些工具和网站收藏">一些工具和网站收藏</a><time datetime="2024-07-20T10:11:15.000Z" title="发表于 2024-07-20 18:11:15">2024-07-20</time></div></div></div></div><div class="card-widget card-webinfo"><div class="item-headline"><i class="fas fa-chart-line"></i><span>网站资讯</span></div><div class="webinfo"><div class="webinfo-item"><div class="item-name">文章数目 :</div><div class="item-count">90</div></div><div class="webinfo-item"><div class="item-name">本站总字数 :</div><div class="item-count">81.5k</div></div><div class="webinfo-item"><div class="item-name">本站访客数 :</div><div class="item-count" id="busuanzi_value_site_uv"></div></div><div class="webinfo-item"><div class="item-name">本站总访问量 :</div><div class="item-count" id="busuanzi_value_site_pv"></div></div><div class="webinfo-item"><div class="item-name">最后更新时间 :</div><div class="item-count" id="last-push-date" data-lastPushDate="2024-10-09T01:48:02.132Z"></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;某年某月 <i class='fas fa-bug fa-spin'></i> By Chen Xs</div><div id="sitetime"><script language="javascript">function siteTime() {
  var seconds = 1000;
  var minutes = seconds * 60;
  var hours = minutes * 60;
  var days = hours * 24;
  var years = days * 365;
  var today = new Date();
  var todayYear = today.getFullYear();
  var todayMonth = today.getMonth() + 1;
  var todayDate = today.getDate();
  var todayHour = today.getHours();
  var todayMinute = today.getMinutes();
  var todaySecond = today.getSeconds();
  // 注意：这里将月份改为02，代表2月，并且添加了8小时的偏移量来转换为北京时间
  var t1 = Date.UTC(2022, 2, 10, 00, 00, 00) + 8 * 60 * 60 * 1000; //北京时间2020-2-13 15:00:00
  var t2 = Date.UTC(todayYear, todayMonth - 1, todayDate, todayHour, todayMinute, todaySecond);
  var diff = t2 - t1;
  var diffDays = Math.floor(diff / days);
  var diffHours = Math.floor((diff % days) / hours);
  var diffMinutes = Math.floor((diff % hours) / minutes);
  var diffSeconds = Math.floor((diff % minutes) / seconds);
  document.getElementById("sitetime").innerHTML = "本站居然运行了" + 
    diffDays + " 天 " +
    diffHours + " 小时 " +
    diffMinutes + " 分钟 " +
    diffSeconds + " 秒 " + `<i class='fas fa-heartbeat fa-beat' style='color: red;'></i>`;
  window.setTimeout("siteTime()", 1000); // 每秒更新时间
}
siteTime(); // 初始调用
</script></div></div><div class="container" id="jsi-flying-fish-container"><script src="/js/fish.js"></script></div><style>   @media only screen and (max-width: 767px){
   #sidebar_search_box input[type=text]{width:calc(100% - 24px)}
}</style></footer></div><div id="rightside"><div id="rightside-config-hide"></div><div id="rightside-config-show"><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.js"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.autoSpacingPage()
  else {
    getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js')
      .then(() => {
        pangu.autoSpacingPage()
      })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguInit)</script><div class="js-pjax"><script>function subtitleType () {
  if (true) { 
    window.typed = new Typed("#subtitle", {
      strings: ["天意昭炯，我自独行","天地虽不容我，心安即是归处"],
      startDelay: 300,
      typeSpeed: 150,
      loop: true,
      backSpeed: 50
    })
  } else {
    document.getElementById("subtitle").innerHTML = '天意昭炯，我自独行'
  }
}

if (true) {
  if (typeof Typed === 'function') {
    subtitleType()
  } else {
    getScript('https://cdn.jsdelivr.net/npm/typed.js/lib/typed.min.js').then(subtitleType)
  }
} else {
  subtitleType()
}</script></div><script src="/js/fish_jquery.js"></script><script src="/js/chocolate.js"></script><script src="/js/fish.js"></script><script defer src="/js/light.js"></script><div class="aplayer no-destroy" data-id="3145079790" data-server="netease" data-type="playlist" data-fixed="true" data-mini="true" data-listFolded="false" data-order="random" data-preload="none" data-autoplay="false" muted></div><canvas class="fireworks" mobile="true"></canvas><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/fireworks.min.js"></script><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = true;
document.body.addEventListener('input', POWERMODE);
</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/SerokSSR/cdn/meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors = ["title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]

var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {

  // removeEventListener scroll 
  window.tocScrollFn && window.removeEventListener('scroll', window.tocScrollFn)
  window.scrollCollect && window.removeEventListener('scroll', scrollCollect)

  typeof preloader === 'object' && preloader.initLoading()
  document.getElementById('rightside').style.cssText = "opacity: ''; transform: ''"
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')

})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof chatBtnFn === 'function' && chatBtnFn()
  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()

  typeof preloader === 'object' && preloader.endLoading()
})

document.addEventListener('pjax:error', (e) => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><!-- hexo injector body_end start --><script data-pjax>
  function butterfly_footer_beautify_injector_config(){
    var parent_div_git = document.getElementById('footer-wrap');
    var item_html = '<p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="博客框架为Hexo" title=""><img src= "https://cdn.jsdelivr.net/gh/cxs1427/my_blog_files/loading.gif" data-lazy-src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&amp;logo=hexo" alt=""/></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px" data-title="主题为Butterfly" title=""><img src= "https://cdn.jsdelivr.net/gh/cxs1427/my_blog_files/loading.gif" data-lazy-src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&amp;logo=bitdefender" alt=""/></a><a class="github-badge" target="_blank" href="https://www.jsdelivr.com/" style="margin-inline:5px" data-title="本站使用JsDelivr为静态资源提供CDN加速" title=""><img src= "https://cdn.jsdelivr.net/gh/cxs1427/my_blog_files/loading.gif" data-lazy-src="https://img.shields.io/badge/CDN-jsDelivr-orange?style=flat&amp;logo=jsDelivr" alt=""/></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" data-title="本站项目由Github托管" title=""><img src= "https://cdn.jsdelivr.net/gh/cxs1427/my_blog_files/loading.gif" data-lazy-src="https://img.shields.io/badge/Source-Github-d021d6?style=flat&amp;logo=GitHub" alt=""/></a></p>';
    console.log('已挂载butterfly_footer_beautify')
    parent_div_git.insertAdjacentHTML("beforeend",item_html)
    }
  var elist = 'null'.split(',');
  var cpage = location.pathname;
  var epage = 'all';
  var flag = 0;

  for (var i=0;i<elist.length;i++){
    if (cpage.includes(elist[i])){
      flag++;
    }
  }

  if ((epage ==='all')&&(flag == 0)){
    butterfly_footer_beautify_injector_config();
  }
  else if (epage === cpage){
    butterfly_footer_beautify_injector_config();
  }
  </script><!-- hexo injector body_end end --></body></html>